---
phase: 06.1-landing-page-redesign
plan: 02
type: execute
wave: 2
depends_on: ["06.1-01"]
files_modified:
  - src/components/react/SmoothScrollProvider.tsx
  - src/components/react/ParallaxHero.tsx
autonomous: true

must_haves:
  truths:
    - "Hero section displays layered parallax effect on scroll"
    - "Text and CTA reveal at bottom as user scrolls"
    - "Parallax is disabled when user prefers reduced motion"
    - "Mobile has reduced/disabled parallax for performance"
  artifacts:
    - path: "src/components/react/SmoothScrollProvider.tsx"
      provides: "Lenis wrapper component for smooth scrolling"
      exports: ["default"]
    - path: "src/components/react/ParallaxHero.tsx"
      provides: "Multi-layer parallax hero with bottom reveal"
      exports: ["default"]
      min_lines: 80
  key_links:
    - from: "src/components/react/ParallaxHero.tsx"
      to: "framer-motion"
      via: "useScroll, useTransform, useReducedMotion hooks"
      pattern: "useScroll|useTransform|useReducedMotion"
    - from: "src/components/react/SmoothScrollProvider.tsx"
      to: "lenis"
      via: "Lenis constructor"
      pattern: "new Lenis"
---

<objective>
Build the multi-layer parallax hero section with smooth scrolling, bottom reveal text/CTA, and accessibility support.

Purpose: Create the dramatic, immersive hero experience specified by user (layered depth parallax with bottom reveal pattern).

Output: SmoothScrollProvider and ParallaxHero React components ready for integration.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06.1-landing-page-redesign/06.1-CONTEXT.md
@.planning/phases/06.1-landing-page-redesign/06.1-RESEARCH.md
@.planning/phases/06.1-landing-page-redesign/06.1-01-SUMMARY.md
@src/components/react/HeroSection.tsx
@src/styles/design-tokens.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SmoothScrollProvider component</name>
  <files>
    src/components/react/SmoothScrollProvider.tsx
  </files>
  <action>
Create `src/components/react/SmoothScrollProvider.tsx`:

1. Import Lenis and React hooks (useEffect)

2. Create SmoothScrollProvider component that:
   - Accepts children prop (ReactNode)
   - Initializes Lenis instance in useEffect with configuration:
     - duration: 1.2 (smooth scroll duration)
     - easing: smooth exponential easing function
     - smoothWheel: true
     - wheelMultiplier: 1.0
   - Sets up requestAnimationFrame loop for Lenis.raf()
   - Cleans up Lenis instance on unmount (lenis.destroy())
   - Returns children wrapped in fragment

3. Export as default

4. Add TypeScript types for children prop

Example structure:
```typescript
import { useEffect, ReactNode } from 'react';
import Lenis from 'lenis';

interface Props {
  children: ReactNode;
}

export default function SmoothScrollProvider({ children }: Props) {
  useEffect(() => {
    const lenis = new Lenis({
      duration: 1.2,
      easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
      smoothWheel: true,
      wheelMultiplier: 1.0,
    });

    function raf(time: number) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }

    requestAnimationFrame(raf);

    return () => lenis.destroy();
  }, []);

  return <>{children}</>;
}
```
  </action>
  <verify>
    - File exists at `src/components/react/SmoothScrollProvider.tsx`
    - `pnpm run check` passes (TypeScript valid)
    - Component can be imported without errors
  </verify>
  <done>
    - SmoothScrollProvider component wraps children with Lenis smooth scroll
    - Proper cleanup on unmount
    - TypeScript types defined
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ParallaxHero component with bottom reveal</name>
  <files>
    src/components/react/ParallaxHero.tsx
  </files>
  <action>
Create `src/components/react/ParallaxHero.tsx`:

1. Import dependencies:
   - framer-motion: useScroll, useTransform, motion, useReducedMotion
   - react: useRef
   - lucide-react: ArrowRight
   - Images from src/assets/images/hero/ (as Astro asset imports)

2. Create ParallaxHero component:

   a. **Reduced Motion Hook:**
      - Use useReducedMotion() to detect user preference
      - If reduced motion, set all parallax transforms to 0 (static images)

   b. **Mobile Detection:**
      - Detect viewport width (window.innerWidth < 768)
      - Reduce parallax intensity by 50% on mobile OR disable entirely
      - Use useEffect + useState for client-side window check

   c. **Scroll Progress Tracking:**
      - Create container ref
      - Use useScroll with target: container, offset: ['start start', 'end start']
      - This tracks scroll from when hero enters viewport to when it exits

   d. **Layer Transforms (when motion allowed):**
      - Background (layer-3): useTransform(scrollYProgress, [0, 1], ['0vh', '30vh']) - slowest
      - Midground (layer-2): useTransform(scrollYProgress, [0, 1], ['0vh', '60vh']) - medium
      - Foreground (layer-1): useTransform(scrollYProgress, [0, 1], ['0vh', '100vh']) - fastest
      - Adjust values for mobile (halve them or set to 0)

   e. **Hero Structure:**
      - Container: relative, h-[150vh] (tall to allow scroll), overflow-hidden
      - Sticky inner container: sticky top-0 h-screen for viewport-locked effect
      - Three motion.div layers with absolute positioning, each containing img
      - Images: w-full h-full object-cover, will-change-transform for optimization
      - Add subtle gradient overlay for text readability

   f. **Bottom Reveal Content:**
      - Position at bottom of sticky container
      - Use motion.div with whileInView animation:
        - initial: { opacity: 0, y: 60 }
        - whileInView: { opacity: 1, y: 0 }
        - viewport: { once: true, margin: "-20%" }
        - transition: smooth easing (duration: 0.8)
      - Content:
        - Headline: "Travel Together, Effortlessly" (text-white, large, bold)
        - Subheadline: value proposition text (text-white/80)
        - CTA button: "Join the Waitlist" linking to #waitlist
      - Background gradient: from-black/60 to transparent for text contrast

   g. **Styling:**
      - Use design token colors via CSS variables or Tailwind classes
      - CTA button uses accent color (#E87B4E / orange-500)
      - Ensure text passes WCAG contrast on image backgrounds

3. Export as default

4. Handle image loading:
   - Images imported as Astro assets will be optimized automatically
   - Add loading="eager" for hero images (above fold)
  </action>
  <verify>
    - File exists at `src/components/react/ParallaxHero.tsx`
    - `pnpm run check` passes
    - Component imports all 3 hero images
    - useReducedMotion hook is called
    - useScroll and useTransform are used for parallax
  </verify>
  <done>
    - ParallaxHero displays 3 layers with parallax scroll effect
    - Text/CTA reveals at bottom on scroll
    - Parallax disabled for prefers-reduced-motion users
    - Mobile has reduced parallax intensity
    - Images use will-change-transform for GPU acceleration
  </done>
</task>

<task type="auto">
  <name>Task 3: Create test page for parallax hero verification</name>
  <files>
    src/pages/test-parallax.astro
  </files>
  <action>
Create `src/pages/test-parallax.astro` to verify parallax hero in isolation:

1. Import components:
   - BaseLayout from layouts
   - SmoothScrollProvider from react components
   - ParallaxHero from react components

2. Page structure:
   ```astro
   ---
   import BaseLayout from '../layouts/BaseLayout.astro';
   import SmoothScrollProvider from '../components/react/SmoothScrollProvider.tsx';
   import ParallaxHero from '../components/react/ParallaxHero.tsx';
   ---

   <BaseLayout title="Parallax Test" description="Testing parallax hero">
     <SmoothScrollProvider client:load>
       <ParallaxHero client:load />
     </SmoothScrollProvider>

     <!-- Spacer to allow scrolling past hero -->
     <div class="h-screen bg-gray-100 flex items-center justify-center">
       <p class="text-2xl text-gray-600">Scroll content below hero</p>
     </div>

     <!-- Manual verification checklist -->
     <div class="p-8 bg-white">
       <h2 class="text-xl font-bold mb-4">Parallax Verification</h2>
       <ul class="space-y-2 text-gray-700">
         <li>[ ] Images load and display</li>
         <li>[ ] Layers move at different speeds on scroll</li>
         <li>[ ] Text reveals smoothly at bottom</li>
         <li>[ ] CTA button is clickable</li>
         <li>[ ] Test with prefers-reduced-motion enabled</li>
         <li>[ ] Test on mobile viewport (DevTools)</li>
       </ul>
     </div>
   </BaseLayout>
   ```

3. Use client:load for both components (parallax needs immediate interactivity)

4. Run dev server and manually verify at /test-parallax
  </action>
  <verify>
    - `src/pages/test-parallax.astro` exists
    - `pnpm run dev` starts without errors
    - Navigate to http://localhost:4321/test-parallax - page loads
    - Parallax hero is visible with images
  </verify>
  <done>
    - Test page exists at /test-parallax
    - ParallaxHero renders with all layers visible
    - Scroll interaction produces parallax effect (manual verification)
    - Bottom reveal text animates on scroll
  </done>
</task>

</tasks>

<verification>
- [ ] `src/components/react/SmoothScrollProvider.tsx` exists and exports default
- [ ] `src/components/react/ParallaxHero.tsx` exists with useScroll/useTransform
- [ ] `src/pages/test-parallax.astro` exists
- [ ] `pnpm run check` passes
- [ ] `pnpm run dev` starts without errors
- [ ] http://localhost:4321/test-parallax shows parallax hero
- [ ] Scrolling produces visible layer movement (different speeds)
- [ ] Text reveals at bottom with animation
</verification>

<success_criteria>
1. SmoothScrollProvider wraps content with Lenis smooth scrolling
2. ParallaxHero displays 3-layer parallax with depth effect on scroll
3. Text and CTA reveal at bottom as user scrolls (whileInView animation)
4. useReducedMotion disables parallax for accessibility
5. Mobile detection reduces or disables parallax for performance
6. Test page allows manual verification of all parallax behaviors
</success_criteria>

<output>
After completion, create `.planning/phases/06.1-landing-page-redesign/06.1-02-SUMMARY.md`
</output>
