---
phase: 01-foundation-setup
plan: 03
type: execute
wave: 2
depends_on: ["01-02"]
files_modified:
  - tsconfig.json
  - src/env.d.ts
autonomous: true

must_haves:
  truths:
    - "TypeScript recognizes .astro files without errors"
    - "React JSX syntax works in .tsx files"
    - "astro check command passes"
  artifacts:
    - path: "tsconfig.json"
      provides: "TypeScript configuration for Astro + React"
      contains: "astro/tsconfigs/strict"
    - path: "src/env.d.ts"
      provides: "Astro client type definitions"
      contains: "astro/client"
  key_links:
    - from: "tsconfig.json"
      to: "astro/tsconfigs/strict"
      via: "extends"
      pattern: "extends.*astro"
    - from: "src/env.d.ts"
      to: "Astro type system"
      via: "triple-slash reference"
      pattern: "reference types.*astro/client"
---

<objective>
Configure TypeScript to support both Astro components and React islands.

Purpose: Astro requires specific TypeScript configuration for .astro file support while maintaining React JSX compatibility. This enables type checking across the entire codebase including future Astro components.

Output: TypeScript configuration that satisfies both Astro and React requirements, verified by passing `astro check`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-setup/01-RESEARCH.md

# Depends on Plan 02 (Astro packages must be installed)
# Current tsconfig.json uses Vite references pattern
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update tsconfig.json for Astro + React</name>
  <files>tsconfig.json</files>
  <action>
Replace the current tsconfig.json content with Astro-compatible configuration:

```json
{
  "extends": "astro/tsconfigs/strict",
  "compilerOptions": {
    "jsx": "react-jsx",
    "jsxImportSource": "react",
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src/**/*", "astro.config.mjs"],
  "exclude": ["node_modules", "dist"]
}
```

Key changes from current config:
- Removes: "files": [], "references": [...] (Vite-specific pattern)
- Adds: "extends": "astro/tsconfigs/strict" (Astro base config)
- Adds: "jsx": "react-jsx" (React 17+ JSX transform)
- Adds: "jsxImportSource": "react" (React JSX factory)
- Adds: Path alias @/* for clean imports
- Adds: Explicit include/exclude for clarity

Note: Keep tsconfig.app.json and tsconfig.node.json files during coexistence period. The dev:vite script may reference them. They will be removed in a later phase.
  </action>
  <verify>
Run: `cat tsconfig.json` - shows new configuration
Run: `npm run check` - should complete (may have warnings for missing .astro files, which is expected)
  </verify>
  <done>
- tsconfig.json extends astro/tsconfigs/strict
- jsx set to react-jsx
- jsxImportSource set to react
- Path alias @/* configured
- Old references array removed
  </done>
</task>

<task type="auto">
  <name>Task 2: Create src/env.d.ts with Astro types</name>
  <files>src/env.d.ts</files>
  <action>
Create src/env.d.ts with Astro client type reference:

```typescript
/// <reference types="astro/client" />
```

This file:
- Provides Astro-specific type definitions
- Enables TypeScript to understand Astro's client directives (client:load, client:visible, etc.)
- Required for proper type checking of .astro files

Note: The existing src/vite-env.d.ts can be kept during coexistence. It doesn't conflict with env.d.ts.
  </action>
  <verify>
Run: `cat src/env.d.ts` - shows reference to astro/client
Run: `npm run check` - completes without type reference errors
  </verify>
  <done>
- src/env.d.ts exists with astro/client reference
- No TypeScript errors related to Astro types
- astro check command recognizes the type definitions
  </done>
</task>

</tasks>

<verification>
1. Config extends Astro: `grep "astro/tsconfigs" tsconfig.json`
2. React JSX enabled: `grep "react-jsx" tsconfig.json`
3. Env types exist: `cat src/env.d.ts`
4. Type check passes: `npm run check` (some warnings OK, no errors)
</verification>

<success_criteria>
- tsconfig.json extends astro/tsconfigs/strict
- React JSX compilation works
- src/env.d.ts provides Astro client types
- `npm run check` passes without errors
- Existing .tsx files still compile correctly
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-setup/01-03-SUMMARY.md`
</output>
