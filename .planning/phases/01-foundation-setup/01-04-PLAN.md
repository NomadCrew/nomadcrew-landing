---
phase: 01-foundation-setup
plan: 04
type: execute
wave: 2
depends_on: ["01-02"]
files_modified:
  - package.json
  - astro.config.mjs
  - tailwind.config.js
  - src/styles/global.css
autonomous: true

must_haves:
  truths:
    - "Tailwind CSS classes work in .astro files"
    - "@tailwindcss/vite plugin is used (not deprecated @astrojs/tailwind)"
    - "Existing Tailwind classes in .tsx files still work"
  artifacts:
    - path: "src/styles/global.css"
      provides: "Tailwind CSS imports for Astro"
      contains: "@import"
    - path: "tailwind.config.js"
      provides: "Tailwind configuration with .astro content path"
      contains: ".astro"
  key_links:
    - from: "astro.config.mjs"
      to: "@tailwindcss/vite"
      via: "vite.plugins array"
      pattern: "tailwind\\(\\)"
    - from: "src/styles/global.css"
      to: "tailwindcss"
      via: "@import"
      pattern: "@import.*tailwindcss"
---

<objective>
Set up Tailwind CSS using the @tailwindcss/vite plugin (not deprecated @astrojs/tailwind).

Purpose: Astro 5.2+ deprecated @astrojs/tailwind in favor of the official Tailwind v4 Vite plugin. This approach provides better performance and is the current recommended setup. Must update content paths to include .astro files.

Output: Tailwind CSS working in both .astro and .tsx files, configured via @tailwindcss/vite plugin.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-setup/01-RESEARCH.md

# Depends on Plan 02 (astro.config.mjs must exist)
# Current tailwind.config.js only includes .tsx files, not .astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install @tailwindcss/vite plugin and update astro.config.mjs</name>
  <files>package.json, astro.config.mjs</files>
  <action>
1. Install the Tailwind Vite plugin:

```bash
npm install --save-dev @tailwindcss/vite@^4.0.0
```

Note: Do NOT install @astrojs/tailwind - it is deprecated for Tailwind v4.

2. Update astro.config.mjs to include the Tailwind plugin:

```javascript
// astro.config.mjs
import { defineConfig } from 'astro/config';
import react from '@astrojs/react';
import tailwindcss from '@tailwindcss/vite';

// https://astro.build/config
export default defineConfig({
  site: 'https://nomadcrew.uk',

  // Static site generation (not SSR)
  output: 'static',

  // React integration for islands
  integrations: [
    react({
      include: ['**/react/*', '**/*.tsx'],
    }),
  ],

  // Vite configuration with Tailwind
  vite: {
    plugins: [tailwindcss()],
  },

  // Dev server configuration
  server: {
    port: 4321,
    host: true,
  },
});
```

Changes:
- Added import: `import tailwindcss from '@tailwindcss/vite';`
- Added plugin: `plugins: [tailwindcss()]` in vite config
  </action>
  <verify>
Run: `npm list @tailwindcss/vite` - shows package installed
Run: `grep "@tailwindcss/vite" astro.config.mjs` - shows import
Run: `grep "tailwindcss()" astro.config.mjs` - shows plugin usage
  </verify>
  <done>
- @tailwindcss/vite@^4.0.0 in devDependencies
- astro.config.mjs imports @tailwindcss/vite
- Tailwind plugin added to vite.plugins array
  </done>
</task>

<task type="auto">
  <name>Task 2: Update tailwind.config.js and create global.css</name>
  <files>tailwind.config.js, src/styles/global.css</files>
  <action>
1. Update tailwind.config.js to include .astro files:

```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx,astro}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

Change: Added "astro" to the content glob pattern.

2. Create src/styles/ directory and global.css:

```bash
mkdir -p src/styles
```

3. Create src/styles/global.css with Tailwind imports:

```css
@import "tailwindcss";
```

This modern Tailwind v4 syntax replaces the old @tailwind directives.

Note: The existing src/index.css with @tailwind directives is kept for the Vite fallback. The global.css file is specifically for Astro layouts.
  </action>
  <verify>
Run: `grep ".astro" tailwind.config.js` - shows .astro in content
Run: `cat src/styles/global.css` - shows @import "tailwindcss"
Run: `ls src/styles/` - directory exists with global.css
  </verify>
  <done>
- tailwind.config.js content includes .astro extension
- src/styles/ directory exists
- src/styles/global.css contains @import "tailwindcss"
- Existing src/index.css preserved for Vite fallback
  </done>
</task>

</tasks>

<verification>
1. Plugin installed: `npm list @tailwindcss/vite`
2. Config updated: `grep "tailwindcss" astro.config.mjs`
3. Content paths: `grep "astro" tailwind.config.js`
4. CSS file exists: `cat src/styles/global.css`
5. No deprecated package: `npm list @astrojs/tailwind` should show "empty" or error
</verification>

<success_criteria>
- @tailwindcss/vite installed (not @astrojs/tailwind)
- astro.config.mjs includes Tailwind Vite plugin
- tailwind.config.js content includes .astro extension
- src/styles/global.css created with Tailwind import
- Existing Tailwind setup preserved for Vite fallback
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-setup/01-04-SUMMARY.md`
</output>
